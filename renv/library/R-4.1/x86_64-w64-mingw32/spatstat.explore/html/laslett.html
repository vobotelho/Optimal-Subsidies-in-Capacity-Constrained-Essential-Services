<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Laslett's Transform</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for laslett {spatstat.explore}"><tr><td>laslett {spatstat.explore}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Laslett's Transform
</h2>

<h3>Description</h3>

<p>Apply Laslett's Transform to a spatial region,
returning the original and transformed regions,
and the original and transformed positions of the lower tangent points.
This is a diagnostic for the Boolean model.
</p>


<h3>Usage</h3>

<pre>
laslett(X, ..., verbose = FALSE, plotit = TRUE, discretise = FALSE,
        type=c("lower", "upper", "left", "right"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>

<p>Spatial region to be transformed.
A window (object of class <code>"owin"</code>) or a logical-valued pixel
image (object of class <code>"im"</code>).
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>Graphics arguments to control the plot (passed to
<code><a href="../../spatstat.explore/help/plot.laslett.html">plot.laslett</a></code> when <code>plotit=TRUE</code>)
or arguments determining the pixel resolution
(passed to <code><a href="../../spatstat.geom/help/as.mask.html">as.mask</a></code>).
</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>

<p>Logical value indicating whether to print progress reports.
</p>
</td></tr>
<tr valign="top"><td><code>plotit</code></td>
<td>

<p>Logical value indicating whether to plot the result.
</p>
</td></tr>
<tr valign="top"><td><code>discretise</code></td>
<td>

<p>Logical value indicating whether polygonal windows should first be
converted to pixel masks before the Laslett transform is
computed. This should be set to <code>TRUE</code> for very complicated
polygons. 
</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>

<p>Type of tangent points to be detected.
This also determines the direction of contraction in the
set transformation.
Default is <code>type="lower"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the lower tangent points of the spatial region <code>X</code>,
then applies Laslett's Transform to the space,
and records the transformed positions of the lower tangent points.
</p>
<p>Laslett's transform is a diagnostic for the Boolean Model.
A test of the Boolean model can be performed by applying a test of CSR
to the transformed tangent points. See the Examples.
</p>
<p>The rationale is that, if the region <code>X</code> was generated by a
Boolean model with convex grains, then the lower tangent points of
<code>X</code>, when subjected to Laslett's transform,
become a Poisson point process (Cressie, 1993, section 9.3.5;
Molchanov, 1997; Barbour and Schmidt, 2001).
</p>
<p>Intuitively, Laslett's transform is a way to account for the fact that
tangent points of <code>X</code> cannot occur <em>inside</em> <code>X</code>.
It treats the interior of <code>X</code> as empty space, and collapses
this empty space so that only the <em>exterior</em> of <code>X</code> remains.
In this collapsed space, the tangent points are completely random.
</p>
<p>Formally, Laslett's transform is a random (i.e. data-dependent)
spatial transformation which maps each spatial
location <i>(x,y)</i> to a new location <i>(x',y)</i> at the same height
<i>y</i>. The transformation is defined so that <i>x'</i>
is the total <em>uncovered</em> length of the line segment from <i>(0,y)</i> to
<i>(x,y)</i>, that is, the total length of the parts of this segment that
fall outside the region <code>X</code>.
</p>
<p>In more colourful terms, suppose we use an abacus to display a
pixellated version of <code>X</code>. Each wire of the abacus represents one
horizontal line in the pixel image. Each pixel lying <em>outside</em>
the region <code>X</code> is represented by a bead of the abacus; pixels
<em>inside</em> <code>X</code> are represented by the absence of a bead. Next
we find any beads which are lower tangent points of <code>X</code>, and
paint them green. Then Laslett's Transform is applied by pushing all
beads to the left, as far as possible. The final locations of all the
beads provide a new spatial region, inside which is the point pattern
of tangent points (marked by the green-painted beads). 
</p>
<p>If <code>plotit=TRUE</code> (the default), a before-and-after plot is
generated, showing the region <code>X</code> and the tangent points
before and after the transformation. This plot can also be generated
by calling <code>plot(a)</code> where <code>a</code> is the object returned by
the function <code>laslett</code>.
</p>
<p>If the argument <code>type</code> is given, then this determines the
type of tangents that will be detected, and also the direction of
contraction in Laslett's transform. The computation is performed
by first rotating <code>X</code>, applying Laslett's transform for lower
tangent points, then rotating back.
</p>
<p>There are separate algorithms for polygonal windows and
pixellated windows (binary masks). The polygonal algorithm may be slow
for very complicated polygons. If this happens, setting
<code>discretise=TRUE</code> will convert the polygonal window to a binary
mask and invoke the pixel raster algorithm.
</p>


<h3>Value</h3>

<p>A list, which also belongs to the class <code>"laslett"</code>
so that it can immediately be printed and plotted.
</p>
<p>The list elements are:
</p>

<dl>
<dt>oldX:</dt><dd><p>the original dataset <code>X</code>;</p>
</dd>
<dt>TanOld:</dt><dd><p>a point pattern, whose window is <code>Frame(X)</code>,
containing the lower tangent points of <code>X</code>;</p>
</dd>
<dt>TanNew:</dt><dd><p>a point pattern, whose window is the Laslett transform
of <code>Frame(X)</code>, and which contains the Laslett-transformed
positions of the tangent points;</p>
</dd>
<dt>Rect:</dt><dd><p>a rectangular window, which is the largest rectangle
lying inside the transformed set;</p>
</dd>
<dt>df:</dt><dd><p>a data frame giving the locations of the tangent points
before and after transformation. </p>
</dd>
<dt>type:</dt><dd><p>character string specifying the type of tangents.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Kassel Hingee and Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>References</h3>

<p>Barbour, A.D. and Schmidt, V. (2001)
On Laslett's Transform for the Boolean Model.
<em>Advances in Applied Probability</em> 
<b>33</b>(1), 1&ndash;5.
</p>
<p>Cressie, N.A.C. (1993)
<em>Statistics for spatial data</em>, second edition.
John Wiley and Sons.
</p>
<p>Molchanov, I. (1997)
<em>Statistics of the Boolean Model for Practitioners and Mathematicians</em>.
Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="../../spatstat.explore/help/plot.laslett.html">plot.laslett</a></code>
</p>


<h3>Examples</h3>

<pre>
a &lt;- laslett(heather$coarse)
transformedHeather &lt;- with(a, Window(TanNew))
plot(transformedHeather, invert=TRUE)

with(a, clarkevans.test(TanNew[Rect], correction="D", nsim=39))

X &lt;- discs(runifrect(15) %mark% 0.2, npoly=16)
b &lt;- laslett(X, type="left")
b
</pre>

<hr /><div style="text-align: center;">[Package <em>spatstat.explore</em> version 3.3-4 <a href="00Index.html">Index</a>]</div>
</body></html>
