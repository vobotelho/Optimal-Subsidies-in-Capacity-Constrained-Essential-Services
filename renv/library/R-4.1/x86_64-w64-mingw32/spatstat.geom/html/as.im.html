<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Convert to Pixel Image</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for as.im {spatstat.geom}"><tr><td>as.im {spatstat.geom}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Convert to Pixel Image</h2>

<h3>Description</h3>

<p>Converts various kinds of data to a pixel image
</p>


<h3>Usage</h3>

<pre>
  as.im(X, ...)

  ## S3 method for class 'im'
as.im(X, W=NULL, ...,
        eps=NULL, dimyx=NULL, xy=NULL,
        rule.eps=c("adjust.eps", "grow.frame", "shrink.frame"),
        na.replace=NULL)

  ## S3 method for class 'owin'
as.im(X, W=NULL, ...,
        eps=NULL, dimyx=NULL, xy=NULL,
        rule.eps=c("adjust.eps", "grow.frame", "shrink.frame"),
        na.replace=NULL, value=1)

  ## S3 method for class 'matrix'
as.im(X, W=NULL, ...)

  ## S3 method for class 'tess'
as.im(X, W=NULL, ..., 
        eps=NULL, dimyx=NULL, xy=NULL,
        rule.eps=c("adjust.eps", "grow.frame", "shrink.frame"),
        na.replace=NULL, values=NULL)

  ## S3 method for class 'function'
as.im(X, W=NULL, ...,
        eps=NULL, dimyx=NULL, xy=NULL,
        rule.eps=c("adjust.eps", "grow.frame", "shrink.frame"),
        na.replace=NULL,
        stringsAsFactors=NULL,
        strict=FALSE, drop=TRUE)

  ## S3 method for class 'funxy'
as.im(X, W=Window(X), ...)

  ## S3 method for class 'expression'
as.im(X, W=NULL, ...)

  ## S3 method for class 'distfun'
as.im(X, W=NULL, ...,
        eps=NULL, dimyx=NULL, xy=NULL,
        rule.eps=c("adjust.eps", "grow.frame", "shrink.frame"),
        na.replace=NULL, approx=TRUE)

  ## S3 method for class 'nnfun'
as.im(X, W=NULL, ...,
        eps=NULL, dimyx=NULL, xy=NULL,
        rule.eps=c("adjust.eps", "grow.frame", "shrink.frame"),
        na.replace=NULL, approx=TRUE)

  ## S3 method for class 'data.frame'
as.im(X, ..., step, fatal=TRUE, drop=TRUE)

  ## Default S3 method:
as.im(X, W=NULL, ...,
        eps=NULL, dimyx=NULL, xy=NULL,
        rule.eps=c("adjust.eps", "grow.frame", "shrink.frame"),
        na.replace=NULL)


</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>
<p>Data to be converted to a pixel image.</p>
</td></tr>
<tr valign="top"><td><code>W</code></td>
<td>
<p>Window object which determines the spatial domain
and pixel array geometry.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>X</code> when <code>X</code>
is a function.</p>
</td></tr>
<tr valign="top"><td><code>eps,dimyx,xy,rule.eps</code></td>
<td>

<p>Optional parameters passed to <code><a href="../help/as.mask.html">as.mask</a></code>
which determine the pixel array geometry.
See <code><a href="../help/as.mask.html">as.mask</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>na.replace</code></td>
<td>
<p>Optional value to replace <code>NA</code> entries in the
output image.
</p>
</td></tr>
<tr valign="top"><td><code>value</code></td>
<td>
<p>Optional.
The value to be assigned to pixels inside the window,
if <code>X</code> is a window. A single atomic value (numeric, integer,
logical etc).
</p>
</td></tr>
<tr valign="top"><td><code>values</code></td>
<td>
<p>Optional.
Vector of values to be assigned to each tile of the tessellation,
when <code>X</code> is a tessellation. An atomic vector (numeric,
integer, logical etc.)
</p>
</td></tr>
<tr valign="top"><td><code>strict</code></td>
<td>

<p>Logical value indicating whether to match formal arguments
of <code>X</code> when <code>X</code> is a function. If <code>strict=FALSE</code>
(the default), all the <code>...</code> arguments are passed to
<code>X</code>. If <code>strict=TRUE</code>, only named arguments
are passed, and only if they match the names of formal arguments of
<code>X</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>step</code></td>
<td>

<p>Optional. A single number, or numeric vector of length 2,
giving the grid step lengths
in the <i>x</i> and <i>y</i> directions.
</p>
</td></tr>
<tr valign="top"><td><code>fatal</code></td>
<td>

<p>Logical value indicating what to do if the resulting image
would be too large for available memory. If <code>fatal=TRUE</code> (the
default), an error occurs. If <code>fatal=FALSE</code>, a warning is
issued and <code>NULL</code> is returned.
</p>
</td></tr>
<tr valign="top"><td><code>drop</code></td>
<td>

<p>Logical value indicating what to do if the result would
normally be a list of pixel images but the list contains
only one image.
If <code>drop=TRUE</code> (the default), the pixel image is extracted
and the result is a pixel image.
If <code>drop=FALSE</code>, this list is returned as the result.
</p>
</td></tr>
<tr valign="top"><td><code>stringsAsFactors</code></td>
<td>

<p>Logical value (passed to <code><a href="../../base/help/data.frame.html">data.frame</a></code>)
specifying how to handle pixel values which
are character strings. If <code>TRUE</code>, character values are
interpreted as factor levels. If <code>FALSE</code>, they remain
as character strings. The default depends on the version of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.
See section <em>Handling Character Strings</em>.
</p>
</td></tr>
<tr valign="top"><td><code>approx</code></td>
<td>

<p>Logical value indicating whether to compute an approximate result
at faster speed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function converts the data <code>X</code> into a pixel image
object of class <code>"im"</code> (see <code><a href="../../spatstat.geom/help/im.object.html">im.object</a></code>).
The function <code>as.im</code> is generic, with methods for the classes
listed above.
</p>
<p>Currently <code>X</code> may be any of the following:
</p>

<ul>
<li>
<p>a pixel image object, of class <code>"im"</code>.
</p>
</li>
<li>
<p>a window object, of class <code>"owin"</code> (see
<code><a href="../../spatstat.geom/help/owin.object.html">owin.object</a></code>). The result is an image
with all pixel entries equal to <code>value</code> inside the window <code>X</code>,
and <code>NA</code> outside.
</p>
</li>
<li>
<p>a matrix. 
</p>
</li>
<li>
<p>a tessellation (object of class <code>"tess"</code>).
By default, the result is a factor-valued image, with one factor level
corresponding to each tile of the tessellation. Pixels are classified
according to the tile of the tessellation into which they fall.
If argument <code>values</code> is given, the result is a pixel image
in which every pixel inside the <code>i</code>-th tile of the tessellation
has pixel value equal to <code>values[i]</code>.
</p>
</li>
<li>
<p>a single number (or a single logical, complex, factor or character
value). The result is an image
with all pixel entries equal to this constant value
inside the window <code>W</code> (and <code>NA</code> outside, unless the
argument <code>na.replace</code> is given).
Argument <code>W</code> is required.
</p>
</li>
<li>
<p>a function of the form <code>function(x, y, ...)</code>
which is to be evaluated to yield the image pixel values.
In this case, the additional argument <code>W</code> must be present.
This window will be converted to
a binary image mask. Then the function <code>X</code> will be evaluated
in the form <code>X(x, y, ...)</code> where <code>x</code> and <code>y</code> are
<b>vectors</b> containing the <i>x</i> and <i>y</i> coordinates
of all the pixels in the image mask, and <code>...</code> are any extra
arguments given. This function must return a
vector or factor of the same length as the input vectors,
giving the pixel values.
</p>
</li>
<li>
<p>an object of class <code>"funxy"</code> representing a
<code>function(x,y,...)</code> defined in a spatial region.
The function will be evaluated as described above.
The window <code>W</code> defaults to the domain of definition of the
function.
</p>
</li>
<li>
<p>an object of class <code>"funxy"</code> which also belongs to one of
the following special classes. If <code>approx=TRUE</code> (the default),
the function will be evaluated approximately using a very fast
algorithm. If <code>approx=FALSE</code>, the function will be evaluated
exactly at each grid location as described above.
</p>

<ul>
<li>
<p>an object of class <code>"distfun"</code> representing a distance function
(created by the command <code><a href="../../spatstat.geom/help/distfun.html">distfun</a></code>).
The fast approximation is 
the distance transform <code><a href="../../spatstat.geom/help/distmap.html">distmap</a></code>.
</p>
</li>
<li>
<p>an object of class <code>"nnfun"</code>
representing a nearest neighbour function
(created by the command <code><a href="../../spatstat.geom/help/nnfun.html">nnfun</a></code>).
The fast approximation is <code><a href="../../spatstat.geom/help/nnmap.html">nnmap</a></code>.
</p>
</li>
<li>
<p>an object of class <code>"densityfun"</code> representing a kernel
estimate of intensity (created by
the command <code><a href="../../spatstat.explore/help/densityfun.html">densityfun</a></code>).
The fast approximation is the Fast Fourier Transform
algorithm in <code><a href="../../spatstat.explore/help/density.ppp.html">density.ppp</a></code>.
</p>
</li>
<li>
<p>an object of class <code>"Smoothfun"</code> 
representing kernel-smoothed values
(created by the command <code><a href="../../spatstat.explore/help/Smoothfun.html">Smoothfun</a></code>).
The fast approximation is the Fast Fourier Transform
algorithm in <code><a href="../../spatstat.explore/help/Smooth.ppp.html">Smooth.ppp</a></code>.
</p>
</li></ul>

</li>
<li>
<p>An <code>expression</code> involving the variables <code>x</code> and <code>y</code>
representing the spatial coordinates, and possibly also involving other
variables.
The additional argument <code>W</code> must be present; it will be converted to
a binary image mask. The expression <code>X</code> will be evaluated
in an environment where <code>x</code> and <code>y</code> are
<b>vectors</b> containing the spatial coordinates
of all the pixels in the image mask.
Evaluation of the expression <code>X</code> must yield a vector or factor,
of the same length as <code>x</code> and <code>y</code>, giving the pixel values.
</p>
</li>
<li>
<p>a list with entries <code>x, y, z</code> in the format expected by
the standard <code>R</code> functions
<code><a href="../../graphics/html/image.html">image.default</a></code> and <code><a href="../../graphics/html/contour.html">contour.default</a></code>.
That is, <code>z</code> is a matrix of pixel values, <code>x</code> and <code>y</code>
are vectors of <i>x</i> and <i>y</i> coordinates respectively,
and <code>z[i,j]</code> is the pixel value for the location
<code>(x[i],y[j])</code>.
</p>
</li>
<li>
<p>a point pattern (object of class <code>"ppp"</code>).
See the separate documentation for <code><a href="../../spatstat.geom/help/as.im.ppp.html">as.im.ppp</a></code>.
</p>
</li>
<li>
<p>A data frame with at least three columns.
Columns named <code>x</code>, <code>y</code> and <code>z</code>, if present,
will be assumed to contain the spatial coordinates and the pixel
values, respectively. Otherwise the <code>x</code> and <code>y</code>
coordinates will be taken from the first two columns of the
data frame, and any remaining columns will be interpreted as
pixel values.
</p>
</li></ul>

<p>The spatial domain (enclosing rectangle) of the pixel image
is determined by the argument <code>W</code>. If <code>W</code> is absent, 
the spatial domain is determined by <code>X</code>.
When <code>X</code> is a function, a matrix, or a single numerical value,
<code>W</code> is required.
</p>
<p>The pixel array dimensions of the final resulting image are determined
by (in priority order)
</p>

<ul>
<li><p> the argument <code>eps</code>, <code>dimyx</code> or <code>xy</code> if present;
</p>
</li>
<li><p> the pixel dimensions of the window <code>W</code>, if it is
present and if it is a binary mask;
</p>
</li>
<li><p> the pixel dimensions of <code>X</code> if it is an image,
a binary mask, or a <code>list(x,y,z)</code>;
</p>
</li>
<li><p> the default pixel dimensions, 
controlled by <code><a href="../../spatstat.geom/help/spatstat.options.html">spatstat.options</a></code>.
</p>
</li></ul>

<p>Note that if <code>eps</code>, <code>dimyx</code> or <code>xy</code>
is given, this will override
the pixel dimensions of <code>X</code> if it has them.
Thus, <code>as.im</code> can be used to change an image's pixel dimensions.
</p>
<p>If the argument <code>na.replace</code> is given, then all <code>NA</code> entries
in the image will be replaced by this value.  The resulting image is
then defined everwhere on the full rectangular domain, instead of a
smaller window. Here <code>na.replace</code> should be a single value,
of the same type as the other entries in the image.
</p>
<p>If <code>X</code> is a pixel image that was created by an older version
of <span class="pkg">spatstat</span>, the command <code>X &lt;- as.im(X)</code> will
repair the internal format of <code>X</code> so that it conforms to the
current version of <span class="pkg">spatstat</span>.
</p>
<p>If <code>X</code> is a data frame with <code>m</code> columns,
then <code>m-2</code> columns of data are interpreted as pixel values,
yielding <code>m-2</code> pixel images. The result of
<code>as.im.data.frame</code> is a list of pixel
images, belonging to the class <code>"imlist"</code>.
If <code>m = 3</code> and <code>drop=TRUE</code> (the default), then the
result is a pixel image rather than a list containing this image.
</p>
<p>If <code>X</code> is a <code>function(x,y)</code> which returns a matrix of
values, then <code>as.im(X, W)</code> will be a list of pixel images.
</p>


<h3>Value</h3>

<p>A pixel image (object of class <code>"im"</code>),
or a list of pixel images, 
or <code>NULL</code> if the conversion failed.
</p>


<h3>Character-valued images</h3>

<p>By default, if the pixel value data are character strings, they will be
treated as levels of a factor, and the resulting image will be
factor-valued. To prevent the conversion of character strings to
factors, use the argument <code>stringsAsFactors=FALSE</code>,
which is recognised by most of the
methods for <code>as.im</code>, or alternatively set
<code>options(stringsAsFactors=FALSE)</code>.
</p>


<h3>Handling Character Strings</h3>

<p>The argument <code>stringsAsFactors</code>
is a logical value (passed to <code><a href="../../base/help/data.frame.html">data.frame</a></code>)
specifying how to handle pixel values which
are character strings. If <code>TRUE</code>, character values are
interpreted as factor levels. If <code>FALSE</code>, they remain
as character strings. The default values of <code>stringsAsFactors</code>
depends on the version of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.
</p>

<ul>
<li><p> In <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions <code>&lt; 4.1.0</code>
the factory-fresh default is <code>stringsAsFactors=FALSE</code> and
the default can be changed by setting
<code>options(stringsAsFactors=FALSE)</code>.
</p>
</li>
<li><p> In <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions <code>&gt;= 4.1.0</code> the default
is <code>stringsAsFactors=FALSE</code> and there is no option to
change the default.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>
</p>


<h3>See Also</h3>

<p>Separate documentation for <code><a href="../../spatstat.geom/help/as.im.ppp.html">as.im.ppp</a></code>
</p>


<h3>Examples</h3>

<pre>
  # window object
  W &lt;- Window(demopat)
  plot(W)
  Z &lt;- as.im(W)
  image(Z)
  # function
  Z &lt;- as.im(function(x,y) {x^2 + y^2}, unit.square())
  image(Z)
  # or as an expression
  Z &lt;- as.im(expression(x^2+y^2), square(1))

  # function with extra arguments
  f &lt;- function(x, y, x0, y0) {
      sqrt((x - x0)^2 + (y-y0)^2)
  }
  Z &lt;- as.im(f, unit.square(), x0=0.5, y0=0.5)
  image(Z)

  # Revisit the Sixties
  Z &lt;- as.im(f, letterR, x0=2.5, y0=2)
  image(Z)
  # usual convention in R
  stuff &lt;- list(x=1:10, y=1:10, z=matrix(1:100, nrow=10))
  Z &lt;- as.im(stuff)
  # convert to finer grid
  Z &lt;- as.im(Z, dimyx=256)

  #' distance functions
  d &lt;- distfun(redwood)
  Zapprox &lt;- as.im(d)
  Zexact &lt;- as.im(d, approx=FALSE)
  plot(solist(approx=Zapprox, exact=Zexact), main="")

  # pixellate the Dirichlet tessellation
  Di &lt;- dirichlet(redwood)
  plot(as.im(Di))
  plot(Di, add=TRUE, border="white")

  # as.im.data.frame is the reverse of as.data.frame.im
  grad &lt;- bei.extra$grad
  slopedata &lt;- as.data.frame(grad)
  slope &lt;- as.im(slopedata)
  unitname(grad) &lt;- unitname(slope) &lt;- unitname(grad) # for compatibility
  all.equal(slope, grad) # TRUE

  ## handling of character values
  as.im("a", W=letterR, na.replace="b")
  as.im("a", W=letterR, na.replace="b", stringsAsFactors=FALSE)
</pre>

<hr /><div style="text-align: center;">[Package <em>spatstat.geom</em> version 3.3-5 <a href="00Index.html">Index</a>]</div>
</div></body></html>
